openapi: 3.0.2
info:
  title: Get Employer
  description: >-
    This is will be an automated information sharing arrangement with Local
    Authorities (LAs) via DWP, with a view to LAs recovering (or remitting) as
    much Housing Benefit (HB) debt as possible, prior to it being subsumption
    into UC. This API fetches information for an employer from the frameworks
    for the given Employee District Number and Reference.
  version: 0.1.0
  contact:
    name: Ravi Sandhu
    email: ravi.sandhu@hmrc.gov.uk
  x-integration-catalogue:
    reviewed-date: 2022-04-22T20:27:05Z
    platform: CORE_IF
    publisher-reference: 1560

paths:
  '/organisations/{empDistrictNumber}/{reference}':
    get:
      summary: 'API#1560 Get Employer'
      description: >
        /organisations/{empDistrictNumber}/{reference} <br>Retrieve details of an
        employer using employer District Number and reference

        ```

        Change Log

        ```

          | Version | Date | Author | Description |
          |---|-----|------|-----|
          | 0.1.0   | 16-03-2020 | Ravi Sandhu | Initial draft for review  |
      operationId: requestEmployerDetails

      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/environment'
        - $ref: '#/components/parameters/correlationId'
        - $ref: '#/components/parameters/empDistrictNumberParam'
        - $ref: '#/components/parameters/referenceParam'
      responses:
        '200':
          description: The Employer details have been returned
          headers:
            CorrelationId:
              $ref: '#/components/headers/CorrelationId'
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/employerResponse'
              example:
                employerNameDetails:
                  name1: 'PAT.A.CAKE'
                  name2: 'PAT.A.CAKE2'
                  telephoneNumber: '12345678'
                  faxNumber: '09876543'
                  emailAddress: 'pat@gmail.com'
                  rlsInd: 'N'
                  code: 'E'
                  fromDate: '2005-02-24'
                  toDate: '2009-04-29'
                  houseID: 'houseID345'
                  addressDetails:
                    addressLine1: '61 HARPERS ROAD'
                    addressLine2: 'NORTHFIELD'
                    addressLine3: 'BIRMINGHAM'
                    addressLine4: 'WEST MIDLANDS'
                    addressLine5: 'UNITED KINGDOM'
                    postcode: 'B31 4AW'
                  homeCountry: 'GB'
                  foreignCountry: 'Dubai'
                  dateDlo: '2006-04-29'
                  type: '1'
                  status: '1'
                  dateCreated: '2006-07-29'
                  dateSuperseded: '2006-09-29'
                  deliveryPtSuffix: 'A'
                  mailSortCode: 'mails'
                  addlDeliveryInfo: 'IT IS ADDL INFO'
                employerHistoryDetails:
                  taxYear: '2016'
                  schemeType: '01'
                employerDetails:
                  instanceId: 6280000075370
                  contractOutRef: '7777777S'
                  uniqueRefDistrict: '961'
                  uniqueReference: '4324586679'
                  tradeClass: 'I3000'
                  startDate: '2005-09-01'
                  endDate: '2007-05-01'
                  endDateCode: 1
                  restartDate: '2007-05-01'
                  xferFromDistrict: '015'
                  xferFromRef: 'MM1'
                  xferToDistrict: '015'
                  xferToRef: 'LY27'
                  liabilityFirstYr: '2008'
                  liabilityLastYr: '2009'
                  reviewYr: '2008'
                  aoDistrict: '961'
                  aoTaxType: 'P'
                  aoReference: '1791156'
                  aoCheckChar: 'R'
                  companyRegNumber: '98643344'
                  oldAOReference: '1791540'
                  oldAODistrict: 'O'
                  oldAOTaxType: 'p'
                  oldAOCheckChar: 'V'
                  sortSequence: '2'
                  agentReference: 'AGENT123'
                  orgUnitInstance: 296101
                  updateTimestamp: '20000511000000000000'
                  districtNumber: '234'
                  reference: '1791156'
        '400':
          description: >
            Bad request

            ```

            A bad request has been made; this could be due to one or more issues
            with the request

            "code"                        "reason"

            INVALID_EMP_DISTRICT_NUMBER    Submission has not passed validation. Invalid parameter empDistrictNumber.

            INVALID_REFERENCE              Submission has not passed validation. Invalid parameter reference.
            
            INVALID_CORRELATIONID          Submission has not passed validation. Invalid Header parameter CorrelationId.

            ```
          headers:
            CorrelationId:
              $ref: '#/components/headers/CorrelationId'
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/errorResponse'
              examples:
                Example1_MultipleErrorCodes:
                  value:
                    failures:
                      - code: INVALID_EMP_DISTRICT_NUMBER
                        reason: >-
                          Submission has not passed validation. Invalid parameter empDistrictNumber.
                      - code: INVALID_REFERENCE
                        reason: >-
                          Submission has not passed validation. Invalid parameter reference.
                Example2_SingleCode:
                  value:
                    code: INVALID_EMP_DISTRICT_NUMBER
                    reason: >-
                     Submission has not passed validation. Invalid parameter empDistrictNumber.
        '404':
          description: >
            ```

            "code"                      "reason"

            NOT_FOUND_EMPLOYER          The remote endpoint has reported that the Employer cannot be found.

            NOT_FOUND_ADDRESS           The remote endpoint has reported that the Employer's address cannot be found.


            ```
          headers:
            CorrelationId:
              $ref: '#/components/headers/CorrelationId'
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/errorResponse'
              example:
                code: NOT_FOUND_EMPLOYER
                reason: >-
                  The remote endpoint has reported that the Employer cannot be found.
        '409':
          description: >
            ```

            "code"                      "reason"

            DUPLICATE_EMPLOYERS         The remote endpoint has reported that more than one Employer was found.


            ```
          headers:
            CorrelationId:
              $ref: '#/components/headers/CorrelationId'
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/errorResponse'
              example:
                code: DUPLICATE_EMPLOYERS
                reason: >-
                  The remote endpoint has reported that more than one Employer was found.
        '500':
          description:  >
            ```

            "code"                      "reason"

            SERVER_ERROR                IF is currently experiencing problems that require live service intervention.


            ```
          headers:
            CorrelationId:
              $ref: '#/components/headers/CorrelationId'
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/errorResponse'
              example:
                code: SERVER_ERROR
                reason: >-
                  IF is currently experiencing problems that require live service intervention.
        '503':
          description: >
            ```

            "code"                      "reason"

            SERVICE_UNAVAILABLE         Dependent systems are currently not responding.


            ```
          headers:
            CorrelationId:
              $ref: '#/components/headers/CorrelationId'
          content:
            application/json;charset=UTF-8:
              schema:
                $ref: '#/components/schemas/errorResponse'
              example:
                code: SERVICE_UNAVAILABLE
                reason: Dependent systems are currently not responding.
servers:
  - url: 'https://hostname'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
  headers:
    CorrelationId:
      description: CorrelationID - Used for traceability purposes when present
      schema:
        type: string
        pattern: '^[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}$'
  parameters:
    environment:
      in: header
      name: Environment
      description: Mandatory. Bearer authentication token
      required: true
      schema:
        type: string
        enum:
          - ist0
          - clone
          - live
    correlationId:
      in: header
      name: CorrelationId
      description: >-
        Optional. A UUID format string for the transaction. If not specified DES
        will create a UUID value to be used
      required: false
      schema:
        type: string
        pattern: '^[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{4}\\-[0-9a-fA-F]{12}$'
    empDistrictNumberParam:
      in: path
      name: empDistrictNumber
      description: Mandatory. Employer District Number
      required: true
      schema:
        type: string
        pattern: '^[A-Za-z0-9]{3}$'
    referenceParam:
      in: path
      name: reference
      description: Mandatory. Reference
      required: true
      schema:
        type: string
        pattern: '^[A-Za-z0-9]{10}$'
  schemas:
    dateType:
      type: string
      description: Date format YYYY-MM-DD
      pattern: >-
        ^(((19|20)([2468][048]|[13579][26]|0[48])|2000)[-]02[-]29|((19|20)[0-9]{2}[-](0[469]|11)[-](0[1-9]|1[0-9]|2[0-9]|30)|(19|20)[0-9]{2}[-](0[13578]|1[02])[-](0[1-9]|[12][0-9]|3[01])|(19|20)[0-9]{2}[-]02[-](0[1-9]|1[0-9]|2[0-8])))$
    employerResponse:
      type: object
      additionalProperties: false
      properties:
        employerNameDetails:
          $ref: '#/components/schemas/employerNameDetailsType'
        employerHistoryDetails:
          type: object
          additionalProperties: false
          properties:
            taxYear:
              type: string
              pattern: '^\d{4}$'
            schemeType:
              type: string
              pattern: '^\d{2}$'
          required:
            - taxYear
            - schemeType
        employerDetails:
          $ref: '#/components/schemas/employerDetailsType'
    errorResponse:
      type: object
      oneOf:
        - $ref: '#/components/schemas/failureResponseElement'
        - $ref: '#/components/schemas/failureResponseArray'
    employerNameDetailsType:
      type: object
      additionalProperties: false
      required:
        - name1
        - name2
        - telephoneNumber
        - faxNumber
        - emailAddress
        - rlsInd
        - code
        - fromDate
        - toDate
        - houseID
        - addressDetails
        - homeCountry
        - foreignCountry
        - dateDlo
        - type
        - status
        - dateCreated
        - dateSuperseded
        - deliveryPtSuffix
        - mailSortCode
        - addlDeliveryInfo
      properties:
        name1:
          type: string
          maxLength: 28
        name2:
          type: string
          maxLength: 28
        telephoneNumber:
          type: string
          maxLength: 15
        faxNumber:
          type: string
          maxLength: 15
        emailAddress:
          type: string
          maxLength: 70
        rlsInd:
          type: string
          maxLength: 1
        code:
          type: string
          maxLength: 1
        fromDate:
          $ref: '#/components/schemas/dateType'
        toDate:
          $ref: '#/components/schemas/dateType'
        houseID:
          type: string
          maxLength: 35
        addressDetails:
          $ref: '#/components/schemas/addressDetails'
        homeCountry:
          type: string
          maxLength: 16
        foreignCountry:
          type: string
          maxLength: 35
        dateDlo:
          $ref: '#/components/schemas/dateType'
        type:
          type: string
          maxLength: 1
        status:
          type: string
          maxLength: 1
        dateCreated:
          $ref: '#/components/schemas/dateType'
        dateSuperseded:
          $ref: '#/components/schemas/dateType'
        deliveryPtSuffix:
          type: string
          maxLength: 2
        mailSortCode:
          type: string
          maxLength: 5
        addlDeliveryInfo:
          type: string
          maxLength: 35
    employerDetailsType:
      type: object
      additionalProperties: false
      required:
        - instanceId
        - contractOutRef
        - uniqueRefDistrict
        - uniqueReference
        - tradeClass
        - startDate
        - endDate
        - endDateCode
        - restartDate
        - xferFromDistrict
        - xferFromRef
        - xferToDistrict
        - xferToRef
        - liabilityFirstYr
        - liabilityLastYr
        - reviewYr
        - aoDistrict
        - aoTaxType
        - aoReference
        - aoCheckChar
        - companyRegNumber
        - oldAOReference
        - oldAODistrict
        - oldAOTaxType
        - oldAOCheckChar
        - sortSequence
        - agentReference
        - orgUnitInstance
        - updateTimestamp
        - districtNumber
        - reference
      properties:
        instanceId:
          type: number
          maximum: 9999999999999.99
          multipleOf: 0.01
        contractOutRef:
          type: string
          maxLength: 8
        uniqueRefDistrict:
          type: string
          maxLength: 3
        uniqueReference:
          type: string
          maxLength: 10
        tradeClass:
          type: string
          maxLength: 5
        startDate:
          $ref: '#/components/schemas/dateType'
        endDate:
          $ref: '#/components/schemas/dateType'
        endDateCode:
          type: integer
          minimum: 0
          maximum: 9
        restartDate:
          $ref: '#/components/schemas/dateType'
        xferFromDistrict:
          type: string
          maxLength: 3
        xferFromRef:
          type: string
          maxLength: 10
        xferToDistrict:
          type: string
          maxLength: 3
        xferToRef:
          type: string
          maxLength: 10
        liabilityFirstYr:
          type: string
          pattern: '^\d{4}$'
        liabilityLastYr:
          type: string
          pattern: '^\d{4}$'
        reviewYr:
          type: string
          pattern: '^\d{4}$'
        aoDistrict:
          type: string
          maxLength: 3
        aoTaxType:
          type: string
          maxLength: 1
        aoReference:
          type: string
          maxLength: 8
        aoCheckChar:
          type: string
          maxLength: 1
        companyRegNumber:
          type: string
          maxLength: 10
        oldAOReference:
          type: string
          maxLength: 8
        oldAODistrict:
          type: string
          maxLength: 3
        oldAOTaxType:
          type: string
          maxLength: 1
        oldAOCheckChar:
          type: string
          maxLength: 1
        sortSequence:
          type: string
          maxLength: 1
        agentReference:
          type: string
          maxLength: 16
        orgUnitInstance:
          type: number
          maximum: 9999999999999.99
          multipleOf: 0.01
        updateTimestamp:
          type: string
          maxLength: 20
        districtNumber:
          type: string
          maxLength: 3
        reference:
          type: string
          maxLength: 10
    addressDetails:
      type: object
      additionalProperties: false
      properties:
        addressLine1:
          $ref: '#/components/schemas/addressLineType'
        addressLine2:
          $ref: '#/components/schemas/addressLineType'
        addressLine3:
          $ref: '#/components/schemas/addressLineType'
        addressLine4:
          $ref: '#/components/schemas/addressLineType'
        addressLine5:
          $ref: '#/components/schemas/addressLineType'
        postcode:
          type: string
          description: >-
            Potential Postcode of the Individual being traced, with optional
            ending wildcard. Allowed wildcard patterns are: 'A1\*', 'A11\*', 'A1
            \*',  'AA1\*', 'AA11\*', 'AA1 1\*', 'AA111\*', 'BFPO\*'
          pattern: >-
            ^(([A-Z]{1,2}\*)|([A-Z]{1,2}[0-9][0-9A-Z]?\*)|([A-Z]{1,2}[0-9][0-9A-Z]?\s?[0-9]\*)|([A-Z]{1,2}[0-9][0-9A-Z]?\s?[0-9][A-Z]{2})|(BFPO\s?[0-9]{1,4})|(BFPO\*))$
      required:
        - addressLine1
        - addressLine2
        - addressLine3
        - addressLine4
        - addressLine5
        - postcode
    addressLineType:
      description: >-
        Between 0 and 35 characters, or between 1 and 34 plus an optional
        wildcard character '*'
      type: string
      pattern: '^(([A-Z0-9 \-,.&''\/\(\)]{0,35})|([A-Z0-9 \-,.&''\/\(\)]{1,34}\*?))$'
    failureResponseElement:
      type: object
      required:
        - code
        - reason
      properties:
        code:
          description: Keys for all the errors returned
          type: string
          pattern: '^[A-Z0-9_-]{1,160}$'
        reason:
          description: A simple description for the failure
          type: string
          minLength: 1
          maxLength: 160
    failureResponseArray:
      type: object
      required:
        - failures
      properties:
        failures:
          type: array
          minItems: 2
          uniqueItems: true
          items:
            $ref: '#/components/schemas/failureResponseElement'
